# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem        1.0
PortGroup         xcode 1.0
PortGroup         github 1.0

github.setup      MacDownApp macdown 0.7.2 v
homepage          https://macdown.uranusjr.com/

categories        editors aqua
license           MIT
maintainers       {gmail.com:herby.gillot @herbygillot} openmaintainer

description       Open source Markdown editor for macOS
long_description  MacDown is an open source Markdown editor for OS X, \
                  inspired by Chen Luo's Mou

# Build process requires the git repository.
fetch.type              git

xcode.scheme            MacDown
xcode.configuration     Release

set bundle_path         "${workpath}/bundle"
set derived_data_path   "${workpath}/XcodeDerivedData"

build.env-append        BUNDLE_PATH="${bundle_path}"
build.pre_args-append   -derivedDataPath "${derived_data_path}" \
                        -workspace ./MacDown.xcworkspace

pre-build {
    file mkdir "${derived_data_path}"
    system -W ${worksrcpath} "${prefix}/bin/git submodule update --init"
    system -W ${worksrcpath} "bundle install --path=${bundle_path}"
    system -W ${worksrcpath} "bundle exec pod install"
}
