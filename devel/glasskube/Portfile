# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           github 1.0

github.setup        glasskube glasskube 0.16.0 v
github.tarball_from releases
distfiles           glasskube_v${version}_darwin_${build_arch}.tar.gz
revision            0
categories          devel
maintainers         openmaintainer {esafak @esafak}
description         Missing Package Manager for Kubernetes
long_description    Deploy, configure and update Kubernetes packages 20x faster than with Helm
license             Apache-2
homepage            https://glasskube.dev/

if {${build_arch} eq "arm64"} {
   checksums        rmd160 e34a610be50e08e1a4904f7bc3291c5bb9e4f246 \
                    sha256 214ee81b2283b08b29f6f3e38d6d081532169b22bbc3a6711debb1672cd42875 \
                    size   14258333
} else {
   checksums        rmd160 fe7963c7018a659a3789ba5d930f547ba2dbdf25 \
                    sha256 62ab41000053c899b63a9262af1f1993b86660d3b3829b6d53c808afe3879638 \
                    size   15291420
}

supported_archs     x86_64 arm64
use_configure       no
build               {}

destroot {
    xinstall -m 755 ${workpath}/glasskube ${destroot}${prefix}/bin/glasskube

    # generate and install the completion scripts
    file mkdir ${destroot}${prefix}/share/bash-completion/completions
    file mkdir ${destroot}${prefix}/share/fish/vendor_completions.d
    file mkdir ${destroot}${prefix}/share/zsh/site-functions
    system "${destroot}${prefix}/bin/glasskube completion bash > ${destroot}${prefix}/share/bash-completion/completions/glasskube"
    system "${destroot}${prefix}/bin/glasskube completion fish > ${destroot}${prefix}/share/fish/vendor_completions.d/glasskube"
    system "${destroot}${prefix}/bin/glasskube completion zsh > ${destroot}${prefix}/share/zsh/site-functions/_glasskube"
}
